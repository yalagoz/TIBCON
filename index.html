<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Geliştirme Planı - İş Akışı Paneli</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <aside class="sidebar">
        <div class="sidebar-header">
            <img src="./images/tibcon_logo.png" alt="Tibcon Logo">
        </div>
        <ul class="sidebar-nav">
            <li>
                <a href="index.html" class="active">
                    <i class="bi bi-lightning-fill"></i>
                    <span>Geliştirme</span>
                </a>
            </li>
            <li>
                <a href="siparisler.html">
                    <i class="bi bi-cart-fill"></i>
                    <span>Siparişler</span>
                </a>
            </li>
        </ul>
        <div class="user-profile">
            <!-- DEĞİŞTİ: Tıklanabilirliği belirtmek için id eklendi -->
            <div class="user-info" id="user-info-container" title="Şifre Değiştir">
                <img id="user-avatar-sidebar" src="" alt="Avatar">
                <div class="user-details"><span id="user-name-sidebar" class="username">Kullanıcı</span><span class="role">admin</span></div>
            </div>
            <button id="logout-button-sidebar" class="logout-btn" title="Çıkış Yap"><i class="bi bi-box-arrow-right"></i></button>
        </div>
    </aside>

    <main class="main-content">
        <header class="content-header">
            <div><h1>Geliştirme Planı</h1><p>Tüm geliştirme görevlerini yönetin</p></div>
        </header>

        <div class="form-card">
            <h3>Yeni Görev Ekle</h3>
            <form id="task-form">
                <div class="mb-3"><label for="task-name" class="form-label">Görev Açıklaması</label><input type="text" class="form-control" id="task-name" required></div>
                <div class="row">
                    <div class="col-md-4 mb-3">
                        <label for="assigned-to" class="form-label">Sorumlu Kişi</label>
                        <select class="form-select" id="assigned-to" required>
                            <option value="" disabled selected>Yükleniyor...</option>
                        </select>
                    </div>
                    <div class="col-md-4 mb-3"><label for="start-date" class="form-label">Başlangıç Tarihi</label><input type="date" class="form-control" id="start-date" required></div>
                    <div class="col-md-4 mb-3"><label for="end-date" class="form-label">Bitiş Tarihi</label><input type="date" class="form-control" id="end-date" required></div>
                </div>
                <button type="submit" class="btn btn-primary">Görevi Kaydet</button>
            </form>
        </div>
        
        <div class="table-container mt-4">
            <h3>Mevcut Görevler</h3>
            <div class="table-responsive">
                <table class="table table-hover align-middle">
                    <thead>
                        <tr><th>Görev</th><th>Sorumlu</th><th>Oluşturan</th><th>Başlangıç</th><th>Bitiş</th><th style="min-width: 150px;">İlerleme</th><th>Kalan Gün</th><th>Durum</th><th>İşlemler</th></tr>
                    </thead>
                    <tbody id="task-list"></tbody>
                </table>
            </div>
        </div>
    </main>

    <!-- YENİ EKLENDİ: Şifre Değiştirme Modalı -->
    <div class="modal fade" id="passwordChangeModal" tabindex="-1" aria-labelledby="passwordChangeModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="passwordChangeModalLabel">Şifre Değiştir</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="password-change-form" novalidate>
                        <div class="mb-3">
                            <label for="current-password" class="form-label">Mevcut Şifre</label>
                            <input type="password" class="form-control" id="current-password" required>
                        </div>
                        <div class="mb-3">
                            <label for="new-password" class="form-label">Yeni Şifre</label>
                            <input type="password" class="form-control" id="new-password" required>
                        </div>
                        <div class="mb-3">
                            <label for="confirm-password" class="form-label">Yeni Şifre (Tekrar)</label>
                            <input type="password" class="form-control" id="confirm-password" required>
                        </div>
                        <div id="password-change-message" class="mt-3"></div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">İptal</button>
                    <button type="submit" form="password-change-form" id="save-password-btn" class="btn btn-primary">Kaydet</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="js/firebase-config.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/app.js"></script>
</body>
</html>